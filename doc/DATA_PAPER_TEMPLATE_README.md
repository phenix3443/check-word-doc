# 数据论文模板规则配置说明

## 概述

本配置文件 `data_paper_template.yaml` 是根据 **数据论文模板（刘尚亮修正版）.docx** 生成的专用检查规则，用于验证科学数据论文是否符合模板要求。

生成时间：2026-01-14

## 模板特征

### 文档结构

数据论文模板要求包含以下章节（按顺序）：

1. **封面部分**
   - 数据集标题
   - 作者信息
   - 单位/机构
   - 通信作者
   - 中文摘要和关键词
   - 英文摘要和关键词

2. **正文部分**
   - 引言（或概述）
   - 1. 数据采集和处理方法
     - 1.1 数据采集方法
     - 1.2.1 数据预处理
   - 2. 数据样本描述
   - 3. 数据质量控制和评估
   - 4. 数据价值和保藏计划
   - 5. 数据使用方法和建议
   - 6. 数据可用性声明

3. **结尾部分**
   - 致谢
   - 数据作者分工职责
   - 参考文献

### 格式要求

#### 标题格式

| 标题级别 | Word样式 | 字体 | 字号 | 段前/段后 |
|---------|---------|-----|------|----------|
| 一级标题 | Heading 2 | 宋体/Times New Roman | 4号 | 0.5行 |
| 二级标题 | Heading 3 | 宋体/Times New Roman | 小4号 | 0.5行 |
| 三级标题 | Heading 4 | 宋体/Times New Roman | 5号 | 0.5行 |

#### 封面格式

| 元素 | 字体 | 字号 | 对齐 | 特殊要求 |
|-----|------|-----|------|---------|
| 数据集标题 | 黑体/Times New Roman | 3号 | 居中 | 加粗 |
| 作者信息 | 华文楷体/Times New Roman | 小4号 | 居中 | - |
| 单位信息 | 宋体/Times New Roman | 5号 | 居中 | - |
| 摘要/关键词 | 华文楷体/Times New Roman | 5号 | 左对齐 | 行距1.15 |

#### 正文格式

- **字体**: 宋体（中文）/ Times New Roman（西文）
- **字号**: 5号或小4号
- **行距**: 1.15倍或1.5倍
- **段落**: 末尾必须有标点符号（。：；！？）

## 配置的规则类别

### 1. 封面检查（COV系列）

- **COV001**: 检查封面必需元素（标题、作者、单位、摘要等）

### 2. 结构完整性（STRUCT系列）

- **STRUCT001-007**: 检查必需章节是否存在
  - 引言/概述
  - 数据采集和处理方法
  - 数据样本描述
  - 数据质量控制和评估
  - 数据价值和保藏计划
  - 数据使用方法和建议
  - 数据可用性声明

### 3. 标题规则（HDG系列）

- **HDG001**: 标题编号连续性检查
- **HDG002-004**: 各级标题字体和字号检查

### 4. 段落规则（PAR系列）

- **PAR001**: 行距检查（1.15或1.5倍）
- **PAR002**: 连续空段落检查
- **PAR003**: 段落末尾标点检查
- **PAR004**: 中文字符间空格检查
- **PAR005**: 英文引号包围中文检查
- **PAR006**: 中文引号配对检查
- **PAR007**: 连续空行检查

### 5. 参考文献规则（REF系列）

- **REF001**: 参考文献章节存在性
- **REF002**: 参考文献引用检查（上标形式）
- **REF003**: 参考文献标题级别检查

### 6. 图表规则（FIG/TBL/T系列）

- **FIG001**: 插图目录检查（可选）
- **FIG002**: 图题注位置检查（图后）
- **TBL001**: 附表目录检查（可选）
- **TBL002**: 表题注位置检查（表前）
- **T001**: 表格尺寸和内容检查

### 7. 字体和格式规则（FONT系列）

- **FONT001**: 封面标题字体格式
- **FONT002**: 封面作者信息字体格式
- **FONT003**: 摘要/关键词字体格式
- **FONT004**: 正文字体格式

### 8. 特殊章节（ACK/AUTH系列）

- **ACK001**: 致谢章节检查
- **AUTH001**: 数据作者分工职责章节检查

### 9. 数值和单位（UNIT系列）

- **UNIT001**: 数值和单位间空格检查
- **UNIT002**: 量、单位和符号说明章节（可选）

## 使用方法

### 基本使用

```bash
# 检查单个文档
poetry run docx-lint my_paper.docx --config config/data_paper_template.yaml

# 输出 JSON 格式
poetry run docx-lint my_paper.docx --config config/data_paper_template.yaml --format json

# 保存报告
poetry run docx-lint my_paper.docx --config config/data_paper_template.yaml --out report.md
```

### 自定义配置

如果需要调整某些规则，可以创建自己的配置文件：

```yaml
# my_config.yaml

# 导入数据论文模板规则
import:
  - "data_paper_template.yaml"

# 禁用某些规则
rules:
  - id: "FONT001"
    enabled: false  # 不检查封面标题字体
  
  # 修改规则参数
  - id: "PAR001"
    params:
      allowed_line_spacing: [1.0, 1.15, 1.5]  # 允许更多行距选项
```

### 批量检查

```bash
# 检查某个目录下的所有 .docx 文件
for file in *.docx; do
  poetry run docx-lint "$file" --config config/data_paper_template.yaml --out "${file%.docx}_report.md"
done
```

## 规则总数统计

| 类别 | 规则数 | 说明 |
|-----|--------|------|
| 封面检查 | 1 | 必需元素检查 |
| 结构完整性 | 7 | 必需章节检查 |
| 标题规则 | 4 | 编号和格式检查 |
| 段落规则 | 7 | 格式和内容检查 |
| 参考文献 | 3 | 存在性和引用检查 |
| 图表规则 | 5 | 目录和题注检查 |
| 字体格式 | 4 | 封面和正文字体 |
| 特殊章节 | 2 | 致谢和作者分工 |
| 数值单位 | 2 | 单位格式检查 |
| **总计** | **35** | **覆盖全部要求** |

## 注意事项

### 1. 字体大小转换

Word 字号与 EMU（English Metric Units）的转换：

- 3号 = 16pt = 203,200 EMUs
- 4号 = 14pt = 177,800 EMUs  
- 小4号 = 12pt = 152,400 EMUs
- 5号 = 10.5pt = 133,350 EMUs

**注意**: 实际检查时可能需要容差，因为 Word 内部表示可能略有不同。

### 2. 样式名称

模板使用的 Word 内置样式：

- `Normal`: 正文
- `Heading 1`: 未使用（预留）
- `Heading 2`: 一级标题
- `Heading 3`: 二级标题
- `Heading 4`: 三级标题

### 3. 可选规则

以下规则标记为 `optional: true`，只在相关内容存在时触发：

- FIG001: 插图目录（只在文档包含图片时检查）
- TBL001: 附表目录（只在文档包含表格时检查）
- UNIT002: 量、单位和符号章节（建议有但非必需）

### 4. 中文引号

模板支持的中文引号对：

- 双引号：`""`（推荐）
- 单引号：`''`
- 书名号：`《》`
- 括号：`（）`、`【】`

### 5. 参考文献格式

参考文献引用应使用上标形式：

- `[1]` - 单个引用
- `[1-3]` - 连续引用
- `[1, 3, 5]` - 多个引用

## 常见问题

### Q1: 如何只检查结构，不检查格式？

A: 创建自定义配置，只启用 STRUCT、HDG001、REF001 等结构规则：

```yaml
import:
  - "data_paper_template.yaml"

# 禁用所有格式规则
rules:
  - id: "FONT001"
    enabled: false
  - id: "FONT002"
    enabled: false
  # ... 其他格式规则
```

### Q2: 字体检查总是失败？

A: 可能原因：

1. 字体名称不匹配（检查是否使用了字体变体，如"宋体-简"）
2. 字号有容差（配置中可能需要调整容差范围）
3. 混合字体（中文和西文使用不同字体是正常的）

解决方法：适当放宽 `allow_font_alternatives` 参数。

### Q3: 如何添加新的检查规则？

A: 有两种方法：

1. **扩展配置**：在配置文件中添加新规则定义
2. **开发新规则类**：如果现有规则类不满足需求，参考 `script/rules/README.md` 开发新的通用规则类

## 更新日志

### v1.0 (2026-01-14)

- ✅ 初始版本
- ✅ 基于"数据论文模板（刘尚亮修正版）"生成
- ✅ 包含 35 条检查规则
- ✅ 覆盖封面、结构、标题、段落、参考文献、图表、字体、特殊章节、数值单位等9大类

## 相关文档

- [ARCHITECTURE.md](../ARCHITECTURE.md) - 整体架构说明
- [README.md](../README.md) - 项目说明
- [script/rules/README.md](../script/rules/README.md) - 规则系统文档
- [doc/plan.md](../doc/plan.md) - vNext 设计文档

## 反馈和贡献

如果发现模板规则与实际需求不符，或有改进建议，欢迎提出 Issue 或 Pull Request。
