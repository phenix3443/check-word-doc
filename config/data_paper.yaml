# 数据论文检查规则
# 基于：数据论文模板（刘尚亮修正版）.docx
# 用途：检查数据论文是否符合模板格式要求

description: "数据论文格式检查"

# 导入基础规则（不导入 structure.yaml，因为其中的规则不适用于所有文档）
import:
  - "base/paragraphs.yaml"
  - "base/headings.yaml"
  - "base/references.yaml"

rules:
  # ============================================================================
  # 1. 必需章节检查（基于模板中的标题）
  # ============================================================================
  
  - id: "STRUCT001"
    enabled: true
    params:
      description: "必须包含'引言'或'概述'章节"
      keywords: ["引  言", "引言", "概  述", "概述"]
      style_prefixes: ["Heading"]
  
  - id: "STRUCT002"
    enabled: true
    params:
      description: "必须包含'数据采集和处理方法'章节"
      keywords: ["数据采集", "处理方法"]
      style_prefixes: ["Heading"]
  
  - id: "STRUCT003"
    enabled: true
    params:
      description: "必须包含'数据样本描述'章节"
      keywords: ["数据样本", "样本描述"]
      style_prefixes: ["Heading"]
  
  - id: "STRUCT004"
    enabled: true
    params:
      description: "必须包含'数据质量控制和评估'章节"
      keywords: ["数据质量", "质量控制", "质量评估"]
      style_prefixes: ["Heading"]
  
  - id: "STRUCT005"
    enabled: true
    params:
      description: "必须包含'数据价值和保藏计划'章节"
      keywords: ["数据价值", "保藏计划"]
      style_prefixes: ["Heading"]
  
  - id: "STRUCT006"
    enabled: true
    params:
      description: "必须包含'数据使用方法和建议'章节"
      keywords: ["数据使用", "使用方法"]
      style_prefixes: ["Heading"]
  
  - id: "STRUCT007"
    enabled: true
    params:
      description: "必须包含'数据可用性声明'章节"
      keywords: ["数据可用性", "可用性声明"]
      style_prefixes: ["Heading"]
  
  - id: "STRUCT008"
    enabled: true
    params:
      description: "必须包含'致谢'章节"
      keywords: ["致  谢", "致谢"]
      style_prefixes: ["Heading"]
  
  - id: "STRUCT009"
    enabled: true
    params:
      description: "必须包含'数据作者分工职责'章节"
      keywords: ["数据作者分工", "作者分工职责"]
      style_prefixes: ["Heading"]
  
  # ============================================================================
  # 2. 封面格式检查
  # ============================================================================
  
  - id: "COV001"
    enabled: true
    params:
      description: "必须包含封面（数据集标题、作者、单位、摘要）"
      keywords: ["数据集", "作者", "单位", "摘要", "Abstract"]
      check_first_n_blocks: 15
      min_keyword_matches: 3
  
  # 封面标题字体：黑体3号加粗居中
  - id: "FONT001"
    enabled: true
    params:
      description: "封面标题应使用黑体3号加粗"
      target_blocks: [0, 1]  # 前2个block（中英文标题）
      expected_font_name: "黑体"
      expected_font_size: 203200  # 16pt = 3号
      expected_bold: true
      font_name_alternatives: ["Times New Roman"]  # 英文部分
  
  # 作者信息：华文楷体小4号居中
  - id: "FONT002"
    enabled: true
    params:
      description: "作者信息应使用华文楷体小4号"
      target_blocks: [1, 2, 3, 4]
      expected_font_name: "华文楷体"
      expected_font_size: 152400  # 12pt = 小4号
      font_name_alternatives: ["Times New Roman"]
  
  # 摘要和关键词：华文楷体5号
  - id: "FONT003"
    enabled: true
    params:
      description: "摘要和关键词应使用华文楷体5号"
      target_blocks: [5, 6]  # 摘要和关键词
      expected_font_name: "华文楷体"
      expected_font_size: 133350  # 10.5pt = 5号
      font_name_alternatives: ["Times New Roman"]
  
  # ============================================================================
  # 3. 标题格式检查
  # ============================================================================
  
  # 一级标题：Heading 2 = 宋体4号
  - id: "HDG002"
    enabled: true
    params:
      description: "一级标题应使用宋体4号"
      target_styles: ["Heading 2"]
      expected_font_name: "宋体"
      expected_font_size: 177800  # 14pt = 4号
      font_name_alternatives: ["Times New Roman"]
  
  # 二级标题：Heading 3 = 宋体小4号
  - id: "HDG003"
    enabled: true
    params:
      description: "二级标题应使用宋体小4号"
      target_styles: ["Heading 3"]
      expected_font_name: "宋体"
      expected_font_size: 152400  # 12pt = 小4号
      font_name_alternatives: ["Times New Roman"]
  
  # 三级标题：Heading 4 = 宋体5号
  - id: "HDG004"
    enabled: true
    params:
      description: "三级标题应使用宋体5号"
      target_styles: ["Heading 4"]
      expected_font_name: "宋体"
      expected_font_size: 133350  # 10.5pt = 5号
      font_name_alternatives: ["Times New Roman"]
  
  # ============================================================================
  # 4. 正文格式检查
  # ============================================================================
  
  # 正文字体：宋体5号
  - id: "FONT004"
    enabled: true
    params:
      description: "正文应使用宋体5号"
      target_styles: ["Normal", "正文", "Body Text"]
      expected_font_name: "宋体"
      expected_font_size: 133350  # 10.5pt = 5号
      font_name_alternatives: ["Times New Roman"]
  
  # 正文行距：1.15倍
  - id: "PAR001"
    enabled: true
    params:
      description: "正文行距应为1.15倍"
      target_styles: ["Normal", "正文", "Body Text"]
      line_spacing: 1.15
      line_spacing_tolerance: 0.1
  
  # 摘要行距：1.15倍
  - id: "ABS001"
    enabled: true
    params:
      description: "摘要行距应为1.15倍"
      pattern: "^(摘要|Abstract)"
      target_styles: ["Normal"]
      line_spacing: 1.15

# ============================================================================
# 全局设置
# ============================================================================
settings:
  strict_mode: false
  
  metadata:
    template_name: "数据论文模板（刘尚亮修正版）"
    template_source: "/Users/lsl/github/phenix3443/idea/22年项目/数据汇交/模板/数据论文模板（刘尚亮修正版）.docx"
    version: "1.0"
    created: "2026-01-14"
    description: "根据数据论文模板自动生成的检查规则"
