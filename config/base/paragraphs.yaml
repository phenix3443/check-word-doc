## 段落格式基线规则
##
## 这些规则适用于所有文档类型，主要检查：
## - 段落内容格式（标点、空格、引号）
## - 段落间距（空行、空段落）
##
version: "vnext"

rules:
  # ============================================================================
  # 连续空段落检查
  # ============================================================================
  - id: "PAR-001"
    enabled: true
    params:
      description: "检查连续空段落"
      max_consecutive: 0  # 允许的最大连续空段落数（0 表示不允许空段落）

  # ============================================================================
  # 段落末尾标点检查
  # ============================================================================
  - id: "PAR-002"
    enabled: true
    params:
      description: "正文或者列表段落末尾必须使用句号或冒号"
      check_punctuation: true
      required_punctuation: ["。", "："]  # 允许的末尾标点
      check_styles: ["Normal", "正文", "List Paragraph", "列表段落"]  # 检查的段落样式
      exclude_short_paragraphs: true  # 是否排除短段落（如标题、关键词等）
      min_length: 10  # 短段落的最小长度阈值（字符数）

  # ============================================================================
  # 中文字符间空格检查
  # ============================================================================
  - id: "PAR-003"
    enabled: true
    params:
      description: "中文字符之间不能有一个或多个空格"
      check_chinese_spacing: true
      check_styles: ["Normal", "正文", "List Paragraph", "列表段落"]

  # ============================================================================
  # 英文引号包围中文检查
  # ============================================================================
  - id: "PAR-004"
    enabled: true
    params:
      description: "中文不能被成对的英文双引号或英文单引号包围"
      check_english_quotes: true
      check_styles: ["Normal", "正文", "List Paragraph", "列表段落"]
      min_chinese_ratio: 0.5  # 被引号包围的内容中，中文字符占比超过此值时报错

  # ============================================================================
  # 中文引号配对检查
  # ============================================================================
  - id: "PAR-005"
    enabled: true
    params:
      description: "中文引号应该左右匹配"
      check_quote_matching: true  # 检查中文引号（""、''、《》等）是否配对
      check_styles: ["Normal", "正文", "List Paragraph", "列表段落"]

  # ============================================================================
  # 连续空行检查
  # ============================================================================
  - id: "PAR-006"
    enabled: true
    params:
      description: "段落之间不要存在连续空行"
      check_consecutive_empty: true
      max_consecutive_empty: 1  # 允许的最大连续空行数
      ignore_page_breaks: true  # 是否忽略分页符导致的空行
